{
    "type": "Ext.Dialog",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "closable": true,
        "closeToolText": "Cerrar",
        "designer|userAlias": "vtn_generar_empresa",
        "designer|userClassName": "vtn_generar_empresa",
        "displayed": true,
        "height": "90%",
        "id": "vtn_generar_empresa",
        "itemId": "vtn_generar_empresa",
        "layout": "center",
        "name": "vtn_generar_empresa",
        "titleAlign": "center",
        "width": "60%"
    },
    "configAlternates": {
        "closable": "boolean",
        "closeToolText": "string",
        "designer|userAlias": "string",
        "designer|userClassName": "string",
        "id": "string",
        "itemId": "string",
        "layout": "string",
        "name": "string",
        "titleAlign": "string",
        "width": "auto",
        "displayed": "boolean",
        "height": "auto"
    },
    "name": "vtn_generar_producto2",
    "designerId": "e23d156f-aa47-462c-b706-bb5232535db5",
    "viewControllerInstanceId": "ad97352c-71b7-4ea2-8dc1-3fd020c240fe",
    "viewModelInstanceId": "f83aa44a-71bf-4458-8cc2-ef8842e0935f",
    "cn": [
        {
            "type": "Ext.form.Panel",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "id": "frm_empresas",
                "width": "100%"
            },
            "configAlternates": {
                "id": "string",
                "width": "auto"
            },
            "name": "MyFormPanel4",
            "designerId": "727e1535-a080-4f5b-a6e7-54b7da11cea8",
            "cn": [
                {
                    "type": "Ext.Container",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "container|align": "center",
                        "container|pack": "center",
                        "layout": "hbox",
                        "margin": "-7 0 10 0",
                        "name": "ctn_image_company"
                    },
                    "configAlternates": {
                        "container|align": "string",
                        "container|pack": "string",
                        "layout": "string",
                        "margin": "auto",
                        "name": "string"
                    },
                    "name": "MyContainer12",
                    "designerId": "7bb855e3-6764-49ed-9921-13395ffd681c",
                    "cn": [
                        {
                            "type": "Ext.Img",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "cls": [
                                    "image-generic-frm"
                                ],
                                "name": "image_frm_company",
                                "src": "https://image.flaticon.com/icons/svg/31/31495.svg"
                            },
                            "configAlternates": {
                                "cls": "typedarray",
                                "name": "string",
                                "src": "uri"
                            },
                            "name": "MyImg1",
                            "designerId": "95082231-a97e-4e24-88c2-23e6cf65e0a9"
                        }
                    ]
                },
                {
                    "type": "Ext.Container",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "layout": "hbox",
                        "name": "ctn_frm_company"
                    },
                    "configAlternates": {
                        "layout": "string",
                        "name": "string"
                    },
                    "name": "MyContainer13",
                    "designerId": "6279f5a0-a5bb-4f08-9374-3a89676814c1",
                    "cn": [
                        {
                            "type": "Ext.Container",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "layout": "vbox",
                                "margin": "0 10 0 0",
                                "name": "ctn_column_left_company",
                                "width": "50%"
                            },
                            "configAlternates": {
                                "height": "auto",
                                "layout": "string",
                                "width": "auto",
                                "margin": "auto",
                                "name": "string"
                            },
                            "name": "MyContainer9",
                            "designerId": "e00519af-1288-407a-984f-52f447d2f913",
                            "cn": [
                                {
                                    "type": "Ext.field.Text",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "label": "NIT",
                                        "labelCls": "my-text",
                                        "name": "nit",
                                        "required": true,
                                        "requiredMessage": "Digite un NIT",
                                        "width": "100%"
                                    },
                                    "configAlternates": {
                                        "name": "string",
                                        "width": "auto",
                                        "cls": "typedarray",
                                        "label": "string",
                                        "required": "boolean",
                                        "requiredMessage": "string",
                                        "validators": "function",
                                        "labelCls": "string"
                                    },
                                    "name": "MyTextField14",
                                    "designerId": "2fdc1767-1b74-426a-a500-42a1ce8aed11",
                                    "cn": [
                                        {
                                            "type": "fixedfunction",
                                            "reference": {
                                                "name": "items",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "designer|params": [
                                                    "value"
                                                ],
                                                "fn": "validators",
                                                "implHandler": [
                                                    "var store= Ext.getStore('store_gestion_empresa');",
                                                    "var Existente=false;",
                                                    "var idCompany=null;",
                                                    "var idForm=Ext.getCmp('frm_empresas').getRecord()?Ext.getCmp('frm_empresas').getRecord().id :null;",
                                                    "store.each(function(record){",
                                                    "    if(value == record.data.nit){",
                                                    "        Existente=true;",
                                                    "        idCompany=record.id;",
                                                    "    }",
                                                    "});",
                                                    "",
                                                    "if ((!Ext.isEmpty(value)) && (Ext.isEmpty(value.trim()))) {",
                                                    "    return \"El campo nit no admite espacios\";",
                                                    "}else if(value.length>50){",
                                                    "    return \"El numero de nit supera el tamaño permitido (50)\";",
                                                    "}else if(!/^([0-9])*$/.test(value)){",
                                                    "  return \"El nit debe ser  un número entero\";",
                                                    "}else if(Existente && idCompany!=idForm){",
                                                    "    return \"Ya existe una empresa con este nit\";",
                                                    "}else{",
                                                    "    return true;",
                                                    "}"
                                                ]
                                            },
                                            "configAlternates": {
                                                "designer|params": "typedarray",
                                                "fn": "string",
                                                "implHandler": "code"
                                            },
                                            "name": "validators",
                                            "designerId": "efe5387e-54f8-4ea7-8b3f-107efd2a1e10"
                                        }
                                    ]
                                },
                                {
                                    "type": "Ext.field.Text",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "label": "Ciudad",
                                        "labelCls": "my-text",
                                        "name": "ciudad",
                                        "required": true,
                                        "requiredMessage": "Digite una ciudad",
                                        "width": "100%"
                                    },
                                    "configAlternates": {
                                        "name": "string",
                                        "width": "auto",
                                        "cls": "typedarray",
                                        "label": "string",
                                        "required": "boolean",
                                        "requiredMessage": "string",
                                        "validators": "function",
                                        "labelCls": "string"
                                    },
                                    "name": "MyTextField16",
                                    "designerId": "5116cf97-0c51-434b-b353-e6aa0f380d58",
                                    "cn": [
                                        {
                                            "type": "fixedfunction",
                                            "reference": {
                                                "name": "items",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "designer|params": [
                                                    "value"
                                                ],
                                                "fn": "validators",
                                                "implHandler": [
                                                    "if(value.length>100){",
                                                    "    return \"La campo ciudad supera el tamaño permitido (100)\";",
                                                    "}else if(/^([0-9])*$/.test(value)){",
                                                    "  return \"El campo ciudad tiene caracteres invalidos.(0-9)\";",
                                                    "}else{",
                                                    "    return true;",
                                                    "}"
                                                ]
                                            },
                                            "configAlternates": {
                                                "designer|params": "typedarray",
                                                "fn": "string",
                                                "implHandler": "code"
                                            },
                                            "name": "validators",
                                            "designerId": "ec4fabfb-d89a-492b-b747-3c78c194897b"
                                        }
                                    ]
                                },
                                {
                                    "type": "Ext.field.Text",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "label": "Telefono",
                                        "labelCls": "my-text",
                                        "name": "telefono",
                                        "required": true,
                                        "requiredMessage": "Digite un telefono",
                                        "width": "100%"
                                    },
                                    "configAlternates": {
                                        "name": "string",
                                        "width": "auto",
                                        "cls": "typedarray",
                                        "label": "string",
                                        "required": "boolean",
                                        "requiredMessage": "string",
                                        "validators": "function",
                                        "labelCls": "string"
                                    },
                                    "name": "MyTextField18",
                                    "designerId": "b332d400-7465-4387-9045-28f165dc898c",
                                    "cn": [
                                        {
                                            "type": "fixedfunction",
                                            "reference": {
                                                "name": "items",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "designer|params": [
                                                    "value"
                                                ],
                                                "fn": "validators",
                                                "implHandler": [
                                                    "var store= Ext.getStore('store_gestion_empresa');",
                                                    "var Existente=false;",
                                                    "var idCompany=null;",
                                                    "var idForm=Ext.getCmp('frm_empresas').getRecord()?Ext.getCmp('frm_empresas').getRecord().id :null;",
                                                    "store.each(function(record){",
                                                    "    if(value == record.data.telefono){",
                                                    "        Existente=true;",
                                                    "        idCompany=record.id;",
                                                    "    }",
                                                    "});",
                                                    "",
                                                    "if ((!Ext.isEmpty(value)) && (Ext.isEmpty(value.trim()))) {",
                                                    "    return \"El campo telefono no admite espacios\";",
                                                    "}else if(value.length>20){",
                                                    "    return \"El numero de telefono supera el tamaño permitido (20)\";",
                                                    "}else if(!/^([0-9])*$/.test(value)){",
                                                    "  return \"El telefono debe ser  un número entero\";",
                                                    "}else if(Existente && idCompany!=idForm){",
                                                    "    return \"Ya existe una empresa con este telefono\";",
                                                    "}else{",
                                                    "    return true;",
                                                    "}"
                                                ]
                                            },
                                            "configAlternates": {
                                                "designer|params": "typedarray",
                                                "fn": "string",
                                                "implHandler": "code"
                                            },
                                            "name": "validators",
                                            "designerId": "a0533cc4-7d93-4adf-9bb6-3f29f8c62352"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "Ext.Container",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "layout": "vbox",
                                "margin": "0 0 0 10",
                                "name": "ctn_column_rigth_company",
                                "width": "50%"
                            },
                            "configAlternates": {
                                "layout": "string",
                                "margin": "auto",
                                "name": "string",
                                "width": "auto"
                            },
                            "name": "MyContainer27",
                            "designerId": "cfd0f9ae-779d-497c-b376-b6a3ed440193",
                            "cn": [
                                {
                                    "type": "Ext.field.Text",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "label": "Nombre",
                                        "labelCls": "my-text",
                                        "name": "nombre",
                                        "required": true,
                                        "requiredMessage": "Digite un nombre",
                                        "width": "100%"
                                    },
                                    "configAlternates": {
                                        "name": "string",
                                        "width": "auto",
                                        "cls": "typedarray",
                                        "label": "string",
                                        "required": "boolean",
                                        "requiredMessage": "string",
                                        "validators": "function",
                                        "labelCls": "string"
                                    },
                                    "name": "MyTextField15",
                                    "designerId": "86a4da7c-f34d-4f24-ab2a-c9778b8d0ce4",
                                    "cn": [
                                        {
                                            "type": "fixedfunction",
                                            "reference": {
                                                "name": "items",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "designer|params": [
                                                    "value"
                                                ],
                                                "fn": "validators",
                                                "implHandler": [
                                                    "if(value.length>100){",
                                                    "    return \"El nombre supera el tamaño permitido (100)\";",
                                                    "}else if(/^([0-9])*$/.test(value)){",
                                                    "  return \"El nombre tiene caracteres invalidos.(0-9)\";",
                                                    "}else{",
                                                    "    return true;",
                                                    "}"
                                                ]
                                            },
                                            "configAlternates": {
                                                "designer|params": "typedarray",
                                                "fn": "string",
                                                "implHandler": "code"
                                            },
                                            "name": "validators",
                                            "designerId": "1abfd95e-f087-4737-91ae-98502dee8158"
                                        }
                                    ]
                                },
                                {
                                    "type": "Ext.field.Text",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "label": "Dirección",
                                        "labelCls": "my-text",
                                        "name": "direccion",
                                        "required": true,
                                        "requiredMessage": "Digite una dirección",
                                        "width": "100%"
                                    },
                                    "configAlternates": {
                                        "name": "string",
                                        "width": "auto",
                                        "cls": "typedarray",
                                        "label": "string",
                                        "required": "boolean",
                                        "requiredMessage": "string",
                                        "validators": "function",
                                        "labelCls": "string"
                                    },
                                    "name": "MyTextField17",
                                    "designerId": "3b97968a-771c-457f-a5a9-7ee5573c9f42",
                                    "cn": [
                                        {
                                            "type": "fixedfunction",
                                            "reference": {
                                                "name": "items",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "designer|params": [
                                                    "value"
                                                ],
                                                "fn": "validators",
                                                "implHandler": [
                                                    "if(value.length>100){",
                                                    "    return \"La dirreción supera el tamaño permitido (100)\";",
                                                    "}else{",
                                                    "    return true;",
                                                    "}"
                                                ]
                                            },
                                            "configAlternates": {
                                                "designer|params": "typedarray",
                                                "fn": "string",
                                                "implHandler": "code"
                                            },
                                            "name": "validators",
                                            "designerId": "a16b775d-a0c0-48d1-9ea4-7d776e8b6396"
                                        }
                                    ]
                                },
                                {
                                    "type": "Ext.field.Text",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "label": "Correo",
                                        "labelCls": "my-text",
                                        "name": "email",
                                        "required": true,
                                        "requiredMessage": "Digite un e-mail",
                                        "width": "100%"
                                    },
                                    "configAlternates": {
                                        "name": "string",
                                        "width": "auto",
                                        "label": "string",
                                        "required": "boolean",
                                        "requiredMessage": "string",
                                        "validators": "function",
                                        "labelCls": "string"
                                    },
                                    "name": "MyTextField19",
                                    "designerId": "4eabad7c-3ee4-4271-b895-a2dafaf99524",
                                    "cn": [
                                        {
                                            "type": "fixedfunction",
                                            "reference": {
                                                "name": "items",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "designer|params": [
                                                    "value"
                                                ],
                                                "fn": "validators",
                                                "implHandler": [
                                                    "var store= Ext.getStore('store_gestion_empresa');",
                                                    "var Existente=false;",
                                                    "var idCompany=null;",
                                                    "var idForm=Ext.getCmp('frm_empresas').getRecord()?Ext.getCmp('frm_empresas').getRecord().id :null;",
                                                    "store.each(function(record){",
                                                    "    if(value == record.data.email){",
                                                    "        Existente=true;",
                                                    "        idCompany=record.id;",
                                                    "    }",
                                                    "});",
                                                    "",
                                                    "if ((!Ext.isEmpty(value)) && (Ext.isEmpty(value.trim()))) {",
                                                    "    return \"El campo correo no admite espacios\";",
                                                    "}else if(value.length>100){",
                                                    "    return \"El correo supera el tamaño permitido (100)\";",
                                                    "}else if(!/^(\")?(?:[^\\.\"])(?:(?:[\\.])?(?:[\\w\\-!#$%&'*+\\/=?\\^_`{|}~]))*\\1@(\\w[\\-\\w]*\\.){1,5}([A-Za-z]){2,6}$/.test(value)){",
                                                    "  return \"Correo invalido.(demo@demo.com)\";",
                                                    "}else if(Existente && idCompany!=idForm){",
                                                    "    return \"Ya existe un cliente con este correo\";",
                                                    "}else{",
                                                    "    return true;",
                                                    "}"
                                                ]
                                            },
                                            "configAlternates": {
                                                "designer|params": "typedarray",
                                                "fn": "string",
                                                "implHandler": "code"
                                            },
                                            "name": "validators",
                                            "designerId": "b51dafc0-4815-44f7-809a-a4056934cbe9"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "Ext.field.Text",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "hidden": true,
                        "label": "Field",
                        "name": "id"
                    },
                    "configAlternates": {
                        "hidden": "boolean",
                        "label": "string",
                        "name": "string"
                    },
                    "name": "MyTextField26",
                    "designerId": "47ca9ddf-3985-4169-9fad-cafee7e21670"
                },
                {
                    "type": "Ext.Container",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "container|align": "center",
                        "container|pack": "center",
                        "height": "30%",
                        "layout": "hbox",
                        "name": "ctn_buttons_company",
                        "padding": "10 0 0 0",
                        "width": "100%"
                    },
                    "configAlternates": {
                        "container|align": "string",
                        "container|pack": "string",
                        "height": "auto",
                        "layout": "string",
                        "padding": "auto",
                        "width": "auto",
                        "name": "string"
                    },
                    "name": "MyContainer17",
                    "designerId": "24346fcf-8788-48f1-b4b3-4cf01a52bac6",
                    "cn": [
                        {
                            "type": "Ext.Button",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "cls": [
                                    "color-buttons"
                                ],
                                "designer|uiInterfaceName": "round",
                                "height": 50,
                                "iconCls": "x-fa fa-check blackIcon",
                                "id": "btn_empresa",
                                "scrollable": "vertical",
                                "ui": "round",
                                "width": 50
                            },
                            "configAlternates": {
                                "cls": "typedarray",
                                "height": "auto",
                                "id": "string",
                                "text": "string",
                                "width": "auto",
                                "designer|uiInterfaceName": "string",
                                "iconCls": "string",
                                "scrollable": "auto",
                                "ui": "string"
                            },
                            "name": "MyButton12",
                            "designerId": "f46fa50d-1548-4940-a37c-2afa50aff324",
                            "cn": [
                                {
                                    "type": "fixedfunction",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "designer|params": [
                                            "button",
                                            "e"
                                        ],
                                        "fn": "handler",
                                        "implHandler": [
                                            "var form = Ext.getCmp('frm_empresas');",
                                            "var values = form.getValues();",
                                            "var peticion;",
                                            "if (form.validate()){",
                                            "    //Ext.getCmp('vtn_generar_producto').mask();",
                                            "    if(form.getRecord()){",
                                            "        var record = form.getRecord();",
                                            "        record.set(values);",
                                            "        Ext.Ajax.request({",
                                            "            url: 'empresaController/actualizarEmpresa',",
                                            "            method: 'POST',",
                                            "            params: {",
                                            "",
                                            "                id: values.id,",
                                            "                nit: values.nit,",
                                            "                nombre: values.nombre,",
                                            "                ciudad: values.ciudad,",
                                            "                direccion: values.direccion,",
                                            "                telefono: values.telefono,",
                                            "                email: values.email",
                                            "",
                                            "            },",
                                            "            success: function(response, opts) {",
                                            "                Ext.getCmp('ctn_company_view').fn_find_company(null);",
                                            "                Ext.getCmp('data_view_company').setStore('');",
                                            "                Ext.getCmp('ctn_company_view').getViewModel().set('filtro',null);",
                                            "                Ext.ComponentQuery.query('[itemId=search_field_company]')[0].setValue('');",
                                            "                Ext.toast('Edición Exitosa', 1000);",
                                            "",
                                            "            },",
                                            "            failure: function(response, opts) {",
                                            "                Ext.toast('Error al llevar a cabo el proceso', 1000);",
                                            "            }",
                                            "        });",
                                            "        Ext.getCmp('vtn_generar_empresa').unmask();",
                                            "        Ext.getCmp('vtn_generar_empresa').close();",
                                            "    }else{",
                                            "        form.submit({",
                                            "",
                                            "            url: \"empresaController/agregarEmpresa\",",
                                            "            waitMsg: 'espere',",
                                            "            success: function(response, opts) {",
                                            "                Ext.getStore('store_gestion_empresa').load();",
                                            "                Ext.getCmp('grd_company').refresh();",
                                            "                var info =Ext.getCmp('ctn_statistics_view').getViewModel().get('filtro');",
                                            "                Ext.getCmp('ctn_statistics_view').fn_find_statistcs(info);",
                                            "                Ext.toast('Creación Exitosa', 1000);",
                                            "",
                                            "            },",
                                            "            failure: function(response, opts) {",
                                            "                Ext.toast('Error al llevar a cabo el proceso', 1000);",
                                            "            }",
                                            "",
                                            "        });",
                                            "        Ext.getCmp('vtn_generar_empresa').unmask();",
                                            "        Ext.getCmp('vtn_generar_empresa').close();",
                                            "",
                                            "    }",
                                            "",
                                            "}else{",
                                            "    Ext.toast('Error al validar el formulario!', 1000);",
                                            "}",
                                            ""
                                        ]
                                    },
                                    "configAlternates": {
                                        "designer|params": "typedarray",
                                        "fn": "string",
                                        "implHandler": "code"
                                    },
                                    "name": "handler",
                                    "designerId": "05a7d70d-48fd-47af-98f3-b5750d5cee65"
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ]
}